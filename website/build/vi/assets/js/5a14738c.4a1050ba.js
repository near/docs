"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3554],{95197:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>h});var r=t(85893),i=t(11151),s=t(71183);const a={id:"core",title:"Transfers"},c=void 0,o={id:"tutorials/nfts/core",title:"Transfers",description:"In this tutorial you'll learn how to implement NFT transfers as defined in the core standards into your smart contract.",source:"@site/i18n/vi/docusaurus-plugin-content-docs/current/3.tutorials/nfts/4-core.md",sourceDirName:"3.tutorials/nfts",slug:"/tutorials/nfts/core",permalink:"/vi/tutorials/nfts/core",draft:!1,unlisted:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/3.tutorials/nfts/4-core.md",tags:[],version:"current",lastUpdatedBy:"Github Actions",lastUpdatedAt:1719825734e3,sidebarPosition:4,frontMatter:{id:"core",title:"Transfers"},sidebar:"tutorials",previous:{title:"Enumeration",permalink:"/vi/tutorials/nfts/enumeration"},next:{title:"Event",permalink:"/vi/tutorials/nfts/events"}},l={},h=[{value:"Gi\u1edbi thi\u1ec7u",id:"introduction",level:2},{value:"C\xe1c s\u1eeda \u0111\u1ed5i v\u1edbi contract",id:"c\xe1c-s\u1eeda-\u0111\u1ed5i-v\u1edbi-contract",level:2},{value:"Transfer function",id:"transfer-function",level:3},{value:"C\xe1c internal helper function",id:"c\xe1c-internal-helper-function",level:3},{value:"assert_one_yocto",id:"assert_one_yocto",level:4},{value:"internal_transfer",id:"internal_transfer",level:4},{value:"Transfer call function",id:"transfer-call-function",level:3},{value:"Redeploy contract",id:"redeploying-contract",level:2},{value:"Test c\xe1c thay \u0111\u1ed5i m\u1edbi",id:"testing-changes",level:2},{value:"Test transfer function",id:"test-transfer-function",level:3},{value:"Test transfer call function",id:"test-transfer-call-function",level:3},{value:"T\u1ed5ng k\u1ebft",id:"t\u1ed5ng-k\u1ebft",level:2}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.p,{children:["In this tutorial you'll learn how to implement NFT transfers as defined in the ",(0,r.jsx)(e.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Core",children:"core standards"})," into your smart contract."]}),"\n",(0,r.jsx)(e.p,{children:"We will define two methods for transferring NFTs:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"nft_transfer"}),": that transfers ownership of an NFT from one account to another"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"nft_transfer_call"}),': that transfers an NFT to a "receiver" and calls a method on the receiver\'s account']}),"\n"]}),"\n",(0,r.jsx)(e.admonition,{title:"Why two transfer methods?",type:"tip",children:(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"nft_transfer"})," is a simple transfer between two user, while ",(0,r.jsx)(e.code,{children:"nft_transfer_call"})," allows you to ",(0,r.jsx)(e.strong,{children:"attach an NFT to a function call"})]})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"introduction",children:"Gi\u1edbi thi\u1ec7u"}),"\n",(0,r.jsxs)(e.p,{children:["Up until this point, you've created a simple NFT smart contract that allows users to mint tokens and view information using the ",(0,r.jsx)(e.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Enumeration",children:"enumeration standards"}),". H\xf4m nay, b\u1ea1n s\u1ebd m\u1edf r\u1ed9ng smart contract c\u1ee7a m\xecnh \u0111\u1ec3 cho ph\xe9p c\xe1c user kh\xf4ng ch\u1ec9 mint token m\xe0 c\xf2n transfer ch\xfang."]}),"\n",(0,r.jsxs)(e.p,{children:["As we did in the ",(0,r.jsx)(e.a,{href:"/vi/tutorials/nfts/minting",children:"minting tutorial"}),", let's break down the problem into multiple subtasks to make our lives easier. Khi m\u1ed9t token \u0111\u01b0\u1ee3c mint, th\xf4ng tin \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef \u1edf 3 n\u01a1i:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"tokens_per_owner"}),": t\u1eadp c\xe1c token cho m\u1ed7i account."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"tokens_by_id"}),": map m\u1ed9t token ID v\u1edbi m\u1ed9t ",(0,r.jsx)(e.code,{children:"Token"})," object."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"token_metadata_by_id"}),": map m\u1ed9t token ID v\u1edbi metadata c\u1ee7a n\xf3."]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"B\xe2y gi\u1edd h\xe3y xem x\xe9t t\xecnh hu\u1ed1ng sau \u0111\xe2y. N\u1ebfu Benji l\xe0 ng\u01b0\u1eddi s\u1edf h\u1eefu token A v\xe0 mu\u1ed1n chuy\u1ec3n n\xf3 cho Mike nh\u01b0 m\u1ed9t m\xf3n qu\xe0 sinh nh\u1eadt, \u0111i\u1ec1u g\xec s\u1ebd x\u1ea3y ra? \u0110\u1ea7u ti\xean, token A s\u1ebd b\u1ecb x\xf3a kh\u1ecfi t\u1eadp c\xe1c token c\u1ee7a Benji v\xe0 \u0111\u01b0\u1ee3c th\xeam v\xe0o t\u1eadp c\xe1c token c\u1ee7a Mike."}),"\n",(0,r.jsxs)(e.p,{children:["N\u1ebfu \u0111\xf3 ch\u1ec9 l\xe0 logic b\u1ea1n th\u1ef1c hi\u1ec7n, b\u1ea1n s\u1ebd g\u1eb7p m\u1ed9t s\u1ed1 v\u1ea5n \u0111\u1ec1. N\u1ebfu b\u1ea1n th\u1ef1c hi\u1ec7n m\u1ed9t ",(0,r.jsx)(e.code,{children:"view"})," call \u0111\u1ec3 truy v\u1ea5n th\xf4ng tin v\u1ec1 token \u0111\xf3 sau khi n\xf3 \u0111\xe3 \u0111\u01b0\u1ee3c chuy\u1ec3n cho Mike, n\xf3 s\u1ebd v\u1eabn tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 r\u1eb1ng Benji l\xe0 ch\u1ee7 s\u1edf h\u1eefu."]}),"\n",(0,r.jsxs)(e.p,{children:["\u0110i\u1ec1u n\xe0y l\xe0 do contract v\u1eabn \u0111ang map token ID v\u1edbi ",(0,r.jsx)(e.code,{children:"Token"})," object c\u0169, object \u0111\xf3 c\xf3 field ",(0,r.jsx)(e.code,{children:"owner_id"})," l\xe0 account ID c\u1ee7a Benji. B\u1ea1n v\u1eabn ph\u1ea3i thay \u0111\u1ed5i c\u1ea5u tr\xfac data c\u1ee7a ",(0,r.jsx)(e.code,{children:"tokens_by_id"}),", v\xec th\u1ebf token ID map v\u1edbi m\u1ed9t ",(0,r.jsx)(e.code,{children:"Token"})," object m\u1edbi m\xe0 Mike s\u1edf h\u1eefu."]}),"\n",(0,r.jsx)(e.p,{children:"V\u1edbi nh\u1eefng g\xec \u0111\xe3 n\xf3i, quy tr\xecnh cu\u1ed1i c\xf9ng khi ch\u1ee7 s\u1edf h\u1eefu chuy\u1ec3n token t\u1edbi ng\u01b0\u1eddi nh\u1eadn s\u1ebd nh\u01b0 sau:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"X\xf3a token kh\u1ecfi t\u1eadp token c\u1ee7a ch\u1ee7 s\u1edf h\u1eefu."}),"\n",(0,r.jsx)(e.li,{children:"Th\xeam token t\u1edbi t\u1eadp token c\u1ee7a ng\u01b0\u1eddi nh\u1eadn."}),"\n",(0,r.jsxs)(e.li,{children:["Map token ID t\u1edbi m\u1ed9t ",(0,r.jsx)(e.code,{children:"Token"})," object m\u1edbi ch\u1ee9a ch\xednh x\xe1c th\xf4ng tin ch\u1ee7 s\u1edf h\u1eefu."]}),"\n"]}),"\n",(0,r.jsxs)(e.admonition,{type:"note",children:[(0,r.jsxs)(e.mdxAdmonitionTitle,{children:["B\u1ea1n c\xf3 th\u1ec3 th\u1eafc m\u1eafc t\u1ea1i sao ch\xfang ta kh\xf4ng s\u1eeda field ",(0,r.jsx)(e.code,{children:"token_metadata_by_id"}),". \u0110i\u1ec1u n\xe0y l\xe0 do b\u1ea5t k\u1ec3 ai s\u1edf h\u1eefu token, token ID s\u1ebd lu\xf4n map t\u1edbi c\xf9ng m\u1ed9t metadata. Metadata s\u1ebd kh\xf4ng bao gi\u1edd thay \u0111\u1ed5i v\xe0 v\xec v\u1eady ch\xfang ta c\xf3 th\u1ec3 \u0111\u1ec3 n\xf3 m\u1ed9t m\xecnh (kh\xf4ng map v\u1edbi m\u1ed9t token Id n\xe0o c\u1ea3). :::"]}),(0,r.jsx)(e.p,{children:"T\u1ea1i th\u1eddi \u0111i\u1ec3m n\xe0y, b\u1ea1n \u0111\xe3 s\u1eb5n s\xe0ng \u0111\u1ec3 ti\u1ebfp t\u1ee5c v\xe0 t\u1ea1o nh\u1eefng s\u1eeda \u0111\u1ed5i quan tr\u1ecdng v\u1edbi smart contract c\u1ee7a m\xecnh."}),(0,r.jsx)(e.hr,{}),(0,r.jsx)(e.h2,{id:"c\xe1c-s\u1eeda-\u0111\u1ed5i-v\u1edbi-contract",children:"C\xe1c s\u1eeda \u0111\u1ed5i v\u1edbi contract"}),(0,r.jsxs)(e.p,{children:["Let's start our journey in the ",(0,r.jsx)(e.code,{children:"nft-contract-skeleton/src/nft_core.rs"})," file."]}),(0,r.jsx)(e.h3,{id:"transfer-function",children:"Transfer function"}),(0,r.jsxs)(e.p,{children:["You'll start by implementing the ",(0,r.jsx)(e.code,{children:"nft_transfer"})," logic. Function n\xe0y s\u1ebd chuy\u1ec3n ",(0,r.jsx)(e.code,{children:"token_id"})," \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh t\u1edbi ",(0,r.jsx)(e.code,{children:"receiver_id"})," v\u1edbi m\u1ed9t tu\u1ef3 ch\u1ecdn ",(0,r.jsx)(e.code,{children:"memo"})," v\xed d\u1ee5 nh\u01b0 ",(0,r.jsx)(e.code,{children:'"Happy Birthday Mike!"'}),"."]}),(0,r.jsx)(s.Ey,{language:"rust",start:"60",end:"80",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-basic/src/nft_core.rs"}),(0,r.jsxs)(e.p,{children:["There are a couple things to notice here. Firstly, we've introduced a new function called ",(0,r.jsx)(e.code,{children:"assert_one_yocto()"}),", which ensures the user has attached exactly one yoctoNEAR to the call. This is a ",(0,r.jsx)(e.a,{href:"/vi/build/smart-contracts/security/one-yocto",children:"security measure"})," to ensure that the user is signing the transaction with a ",(0,r.jsx)(e.a,{href:"/vi/concepts/protocol/access-keys",children:"full access key"}),"."]}),(0,r.jsx)(e.p,{children:"Since the transfer function is potentially transferring very valuable assets, you'll want to make sure that whoever is calling the function has a full access key."}),(0,r.jsxs)(e.p,{children:["Secondly, we've introduced an ",(0,r.jsx)(e.code,{children:"internal_transfer"})," method. This will perform all the logic necessary to transfer an NFT."]}),(0,r.jsx)("hr",{class:"subsection"}),(0,r.jsx)(e.h3,{id:"c\xe1c-internal-helper-function",children:"C\xe1c internal helper function"}),(0,r.jsxs)(e.p,{children:["Let's quickly move over to the ",(0,r.jsx)(e.code,{children:"nft-contract/src/internal.rs"})," file so that you can implement the ",(0,r.jsx)(e.code,{children:"assert_one_yocto()"})," and ",(0,r.jsx)(e.code,{children:"internal_transfer"})," methods."]}),(0,r.jsxs)(e.p,{children:["Let's start with the easier one, ",(0,r.jsx)(e.code,{children:"assert_one_yocto()"}),"."]}),(0,r.jsx)(e.h4,{id:"assert_one_yocto",children:"assert_one_yocto"}),(0,r.jsx)(s.Ey,{language:"rust",start:"14",end:"21",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-basic/src/internal.rs"}),(0,r.jsx)(e.h4,{id:"internal_transfer",children:"internal_transfer"}),(0,r.jsxs)(e.p,{children:["It's now time to explore the ",(0,r.jsx)(e.code,{children:"internal_transfer"})," function which is the core of this tutorial. This function takes the following parameters:"]}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"sender_id"}),": account \u0111ang c\u1ed1 g\u1eafng chuy\u1ec3n token."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"receiver_id"}),": account nh\u1eadn token."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"token_id"}),": token ID \u0111ang \u0111\u01b0\u1ee3c chuy\u1ec3n."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"memo"}),": m\u1ed9t t\xf9y ch\u1ecdn memo k\xe8m theo."]}),"\n"]}),(0,r.jsxs)(e.p,{children:["The first thing we have to do is to make sure that the sender is authorized to transfer the token. In this case, we just make sure that the sender is the owner of the token. We do that by getting the ",(0,r.jsx)(e.code,{children:"Token"})," object using the ",(0,r.jsx)(e.code,{children:"token_id"})," and making sure that the sender is equal to the token's ",(0,r.jsx)(e.code,{children:"owner_id"}),"."]}),(0,r.jsxs)(e.p,{children:["Second, we remove the token ID from the sender's list and add the token ID to the receiver's list of tokens. Finally, we create a new ",(0,r.jsx)(e.code,{children:"Token"})," object with the receiver as the owner and remap the token ID to that newly created object."]}),(0,r.jsxs)(e.p,{children:["We want to create this function within the contract implementation (below the ",(0,r.jsx)(e.code,{children:"internal_add_token_to_owner"})," you created in the minting tutorial)."]}),(0,r.jsx)(s.Ey,{language:"rust",start:"96",end:"132",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-basic/src/internal.rs"}),(0,r.jsxs)(e.p,{children:["Now let's look at the function called ",(0,r.jsx)(e.code,{children:"internal_remove_token_from_owner"}),". That function implements the functionality for removing a token ID from an owner's set."]}),(0,r.jsxs)(e.p,{children:["In the remove function, we get the set of tokens for a given account ID and then remove the passed in token ID. If the account's set is empty after the removal, we simply remove the account from the ",(0,r.jsx)(e.code,{children:"tokens_per_owner"})," data structure."]}),(0,r.jsx)(s.Ey,{language:"rust",start:"71",end:"94",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-basic/src/internal.rs"}),(0,r.jsxs)(e.p,{children:["B\xe2y gi\u1edd, file ",(0,r.jsx)(e.code,{children:"internal.rs"})," c\u1ee7a b\u1ea1n s\u1ebd c\xf3 outline nh\u01b0 d\u01b0\u1edbi \u0111\xe2y:"]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"internal.rs\n\u251c\u2500\u2500 hash_account_id\n\u251c\u2500\u2500 assert_one_yocto\n\u251c\u2500\u2500 refund_deposit\n\u2514\u2500\u2500 impl Contract\n    \u251c\u2500\u2500 internal_add_token_to_owner\n    \u251c\u2500\u2500 internal_remove_token_from_owner\n    \u2514\u2500\u2500 internal_transfer\n"})}),(0,r.jsx)("hr",{class:"subsection"}),(0,r.jsx)(e.h3,{id:"transfer-call-function",children:"Transfer call function"}),(0,r.jsxs)(e.p,{children:["The idea behind the ",(0,r.jsx)(e.code,{children:"nft_transfer_call"})," function is to transfer an NFT to a receiver while calling a method on the receiver's contract all in the same transaction."]}),(0,r.jsxs)(e.p,{children:["This way, we can effectively ",(0,r.jsx)(e.strong,{children:"attach an NFT to a function call"}),"."]}),(0,r.jsx)(s.Ey,{language:"rust",start:"82",end:"126",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-basic/src/nft_core.rs"}),(0,r.jsxs)(e.p,{children:["Tr\u01b0\u1edbc ti\xean, function s\u1ebd x\xe1c nh\u1eadn r\u1eb1ng ng\u01b0\u1eddi g\u1ecdi \u0111\xe3 \u0111\xednh k\xe8m ch\xednh x\xe1c 1 yocto cho m\u1ee5c \u0111\xedch b\u1ea3o m\u1eadt. N\xf3 sau \u0111\xf3 s\u1ebd transfer NFT s\u1eed d\u1ee5ng ",(0,r.jsx)(e.code,{children:"internal_transfer"})," v\xe0 b\u1eaft \u0111\u1ea7u cross contract call. It will call the method ",(0,r.jsx)(e.code,{children:"nft_on_transfer"})," on the ",(0,r.jsx)(e.code,{children:"receiver_id"}),"'s contract, and create a promise to call back ",(0,r.jsx)(e.code,{children:"nft_resolve_transfer"})," with the result. This is a very common workflow when dealing with ",(0,r.jsx)(e.a,{href:"/vi/build/smart-contracts/anatomy/crosscontract",children:"cross contract calls"}),"."]}),(0,r.jsxs)(e.p,{children:["As dictated by the core standard, the function we are calling (",(0,r.jsx)(e.code,{children:"nft_on_transfer"}),") needs to return a boolean stating whether or not you should return the NFT to it's original owner."]}),(0,r.jsx)(s.Ey,{language:"rust",start:"146",end:"201",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-basic/src/nft_core.rs"}),(0,r.jsxs)(e.p,{children:["If ",(0,r.jsx)(e.code,{children:"nft_on_transfer"})," returned true or the called failed, you should send the token back to it's original owner. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu tr\u1ea3 v\u1ec1 false th\xec kh\xf4ng c\u1ea7n th\xeam logic n\xe0o c\u1ea3."]}),(0,r.jsxs)(e.p,{children:["As for the return value of our function ",(0,r.jsx)(e.code,{children:"nft_resolve_transfer"}),", the standard dictates that the function should return a boolean indicating whether or not the receiver successfully received the token or not."]}),(0,r.jsxs)(e.p,{children:["\u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a l\xe0 n\u1ebfu ",(0,r.jsx)(e.code,{children:"nft_on_transfer"})," tr\u1ea3 v\u1ec1 true, b\u1ea1n n\xean tr\u1ea3 v\u1ec1 false. B\u1edfi v\xec n\u1ebfu token \u0111ang \u0111\u01b0\u1ee3c tr\u1ea3 l\u1ea1i cho ch\u1ee7 s\u1edf h\u1eefu ban \u0111\u1ea7u c\u1ee7a n\xf3, th\xec cu\u1ed1i c\xf9ng ",(0,r.jsx)(e.code,{children:"receiver_id"})," \u0111\xe3 kh\xf4ng nh\u1eadn \u0111\u01b0\u1ee3c th\xe0nh c\xf4ng token. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu ",(0,r.jsx)(e.code,{children:"nft_on_transfer"})," tr\u1ea3 v\u1ec1 false, b\u1ea1n n\xean tr\u1ea3 v\u1ec1 true v\xec ch\xfang ta kh\xf4ng c\u1ea7n tr\u1ea3 v\u1ec1 token v\xe0 do \u0111\xf3 ",(0,r.jsx)(e.code,{children:"receiver_id"})," s\u1edf h\u1eefu th\xe0nh c\xf4ng token."]}),(0,r.jsx)(e.p,{children:"V\u1edbi vi\u1ec7c ho\xe0n th\xe0nh \u0111i\u1ec1u \u0111\xf3, b\u1ea1n \u0111\xe3 th\xeam th\xe0nh c\xf4ng logic c\u1ea7n thi\u1ebft \u0111\u1ec3 cho ph\xe9p ng\u01b0\u1eddi d\xf9ng transfer c\xe1c NFT. B\xe2y gi\u1edd l\xe0 l\xfac deploy v\xe0 th\u1ef1c hi\u1ec7n m\u1ed9t v\xe0i b\xe0i test."}),(0,r.jsx)(e.hr,{}),(0,r.jsx)(e.h2,{id:"redeploying-contract",children:"Redeploy contract"}),(0,r.jsx)(e.p,{children:"Using cargo-near, deploy the contract as you did in the previous tutorials:"}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"cargo near deploy $NFT_CONTRACT_ID without-init-call network-config testnet sign-with-keychain send\n"})}),(0,r.jsxs)(e.admonition,{type:"tip",children:[(0,r.jsxs)(e.mdxAdmonitionTitle,{children:["N\u1ebfu b\u1ea1n ch\u01b0a ho\xe0n th\xe0nh c\xe1c b\xe0i h\u01b0\u1edbng d\u1eabn tr\u01b0\u1edbc \u0111\xf3 v\xe0 m\u1edbi ch\u1ec9 theo d\xf5i b\xe0i n\xe0y, \u0111\u01a1n gi\u1ea3n h\xe3y t\u1ea1o m\u1ed9t account v\xe0 login v\u1edbi CLI c\u1ee7a m\xecnh b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng ",(0,r.jsx)(e.code,{children:"near login"}),". B\u1ea1n c\xf3 th\u1ec3 export m\u1ed9t bi\u1ebfn m\xf4i tr\u01b0\u1eddng ",(0,r.jsx)(e.code,{children:"export NFT_CONTRACT_ID=YOUR_ACCOUNT_ID_HERE"}),". :::"]}),(0,r.jsx)(e.hr,{}),(0,r.jsx)(e.h2,{id:"testing-changes",children:"Test c\xe1c thay \u0111\u1ed5i m\u1edbi"}),(0,r.jsxs)(e.p,{children:["B\xe2y gi\u1edd th\xec b\u1ea1n \u0111\xe3 deploy m\u1ed9t b\u1ea3n v\xe1 l\u1ed7i cho contract, \u0111\xe3 \u0111\u1ebfn l\xfac \u0111\u1ec3 chuy\u1ec3n sang giai \u0111o\u1ea1n test. S\u1eed d\u1ee5ng NFT contract tr\u01b0\u1edbc \u0111\xf3 m\xe0 b\u1ea1n \u0111\xe3 \u0111\xe3 mint token cho ch\xednh m\xecnh, b\u1ea1n c\xf3 th\u1ec3 test method ",(0,r.jsx)(e.code,{children:"nft_transfer"}),". N\u1ebfu b\u1ea1n transfer NFT, n\xf3 s\u1ebd b\u1ecb xo\xe1 kh\u1ecfi c\xe1c b\u1ed9 s\u01b0u t\u1eadp trong account c\u1ee7a b\u1ea1n \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb \u1edf wallet. Ngo\xe0i ra, n\u1ebfu b\u1ea1n truy v\u1ea5n b\u1ea5t k\u1ef3 enumeration function n\xe0o, n\xf3 s\u1ebd cho th\u1ea5y r\u1eb1ng b\u1ea1n kh\xf4ng c\xf2n l\xe0 ch\u1ee7 s\u1edf h\u1eefu n\u1eefa."]}),(0,r.jsxs)(e.p,{children:["H\xe3y test \u0111i\u1ec1u n\xe0y b\u1eb1ng c\xe1ch transfer m\u1ed9t NFT t\u1edbi account ",(0,r.jsx)(e.code,{children:"benjiman.testnet"})," v\xe0 xem NFT c\xf3 c\xf2n thu\u1ed9c quy\u1ec1n s\u1edf h\u1eefu c\u1ee7a b\u1ea1n hay kh\xf4ng."]}),(0,r.jsx)("hr",{class:"subsection"}),(0,r.jsx)(e.h3,{id:"test-transfer-function",children:"Test transfer function"}),(0,r.jsxs)(e.admonition,{type:"note",children:[(0,r.jsxs)(e.mdxAdmonitionTitle,{children:["\u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a r\u1eb1ng NFT kh\xf4ng th\u1ec3 kh\xf4i ph\u1ee5c \u0111\u01b0\u1ee3c tr\u1eeb khi account ",(0,r.jsx)(e.code,{children:"benjiman.testnet"})," transfer n\xf3 l\u1ea1i cho b\u1ea1n. N\u1ebfu b\u1ea1n kh\xf4ng mu\u1ed1n NFT c\u1ee7a m\xecnh b\u1ecb m\u1ea5t, t\u1ea1o m\u1ed9t account m\u1edbi v\xe0 transfer token t\u1edbi account \u0111\xf3. :::"]}),(0,r.jsxs)(e.p,{children:["N\u1ebfu b\u1ea1n ch\u1ea1y command sau, n\xf3 s\u1ebd transfer token ",(0,r.jsx)(e.code,{children:'"token-1"'})," t\u1edbi account ",(0,r.jsx)(e.code,{children:"benjiman.testnet"})," v\u1edbi memo ",(0,r.jsx)(e.code,{children:'"Go Team :)"'}),". H\xe3y l\u01b0u \xfd r\u1eb1ng b\u1ea1n c\u0169ng \u0111ang \u0111\xednh k\xe8m ch\xednh x\xe1c 1 yoctoNEAR b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng ",(0,r.jsx)(e.code,{children:"--depositYocto"})," flag."]}),(0,r.jsxs)(e.admonition,{type:"tip",children:[(0,r.jsxs)(e.mdxAdmonitionTitle,{children:["N\u1ebfu b\u1ea1n \u0111\xe3 s\u1eed d\u1ee5ng m\u1ed9t token ID kh\xe1c trong nh\u1eefng b\xe0i h\u01b0\u1edbng d\u1eabn tr\u01b0\u1edbc, thay th\u1ebf ",(0,r.jsx)(e.code,{children:"token-1"})," v\u1edbi token ID c\u1ee7a b\u1ea1n. :::"]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'near contract call-function as-transaction $NFT_CONTRACT_ID nft_transfer json-args \'{"receiver_id": "benjiman.testnet", "token_id": "token-1", "memo": "Go Team :)"}\' prepaid-gas \'100.0 Tgas\' attached-deposit \'1 yoctoNEAR\' sign-as $NFT_CONTRACT_ID network-config testnet sign-with-legacy-keychain send\n'})}),(0,r.jsxs)(e.p,{children:["N\u1ebfu b\xe2y gi\u1edd b\u1ea1n truy v\u1ea5n t\u1ea5t c\u1ea3 c\xe1c token m\xe0 account b\u1ea1n s\u1edf h\u1eefu, token \u0111\xf3 s\u1ebd b\u1ecb thi\u1ebfu. T\u01b0\u01a1ng t\u1ef1, n\u1ebfu b\u1ea1n truy v\u1ea5n danh s\xe1ch c\xe1c token \u0111\u01b0\u1ee3c s\u1edf h\u1eefu b\u1edfi ",(0,r.jsx)(e.code,{children:"benjiman.testnet"}),", account \u0111\xf3 b\xe2y gi\u1edd s\u1ebd s\u1edf h\u1eefu NFT c\u1ee7a b\u1ea1n."]}),(0,r.jsx)("hr",{class:"subsection"}),(0,r.jsx)(e.h3,{id:"test-transfer-call-function",children:"Test transfer call function"}),(0,r.jsxs)(e.p,{children:["B\xe2y gi\u1edd th\xec b\u1ea1n \u0111\xe3 test ",(0,r.jsx)(e.code,{children:"nft_transfer"})," function, \u0111\u1ebfn l\xfac \u0111\u1ec3 test ",(0,r.jsx)(e.code,{children:"nft_transfer_call"})," function. N\u1ebfu b\u1ea1n c\u1ed1 g\u1eafng transfer m\u1ed9t NFT t\u1edbi m\u1ed9t ng\u01b0\u1eddi nh\u1eadn ",(0,r.jsx)(e.strong,{children:"kh\xf4ng"})," ti\u1ebfn h\xe0nh ",(0,r.jsx)(e.code,{children:"nft_on_transfer"})," function, contract s\u1ebd panic v\xe0 NFT s\u1ebd ",(0,r.jsx)(e.strong,{children:"kh\xf4ng"})," \u0111\u01b0\u1ee3c transfer. H\xe3y test ch\u1ee9c n\u0103ng n\xe0y b\xean d\u01b0\u1edbi."]}),(0,r.jsx)(e.p,{children:"\u0110\u1ea7u ti\xean mint m\u1ed9t NFT m\u1edbi s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 test ch\u1ee9c n\u0103ng transfer call."}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'near contract call-function as-transaction $NFT_CONTRACT_ID nft_mint json-args \'{"token_id": "token-2", "metadata": {"title": "NFT Tutorial Token", "description": "Testing the transfer call function", "media": "https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif"}, "receiver_id": "\'$NFT_CONTRACT_ID\'"}\' prepaid-gas \'100.0 Tgas\' attached-deposit \'0.1 NEAR\' sign-as $NFT_CONTRACT_ID network-config testnet sign-with-legacy-keychain send\n'})}),(0,r.jsxs)(e.p,{children:["B\xe2y gi\u1edd th\xec b\u1ea1n \u0111\xe3 mint token, b\u1ea1n c\xf3 th\u1ec3 th\u1eed transfer NFT t\u1edbi account ",(0,r.jsx)(e.code,{children:"no-contract.testnet"}),", account n\xe0y kh\xf4ng c\xf3 contract n\xe0o gi\u1ed1ng nh\u01b0 t\xean c\u1ee7a n\xf3 \u0111\xe3 cho th\u1ea5y. \u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a r\u1eb1ng ng\u01b0\u1eddi nh\u1eadn kh\xf4ng ti\u1ebfn h\xe0nh ",(0,r.jsx)(e.code,{children:"nft_on_transfer"})," function v\xe0 NFT s\u1ebd v\u1eabn l\xe0 c\u1ee7a b\u1ea1n sau khi transaction ho\xe0n th\xe0nh."]}),(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'near contract call-function as-transaction $NFT_CONTRACT_ID nft_transfer_call json-args \'{"receiver_id": "no-contract.testnet", "token_id": "token-2", "msg": "foo"}\' prepaid-gas \'100.0 Tgas\' attached-deposit \'1 yoctoNEAR\' sign-as $NFT_CONTRACT_ID network-config testnet sign-with-legacy-keychain send\n'})}),(0,r.jsxs)(e.p,{children:["N\u1ebfu b\u1ea1n truy v\u1ea5n c\xe1c token c\u1ee7a m\xecnh, b\u1ea1n s\u1ebd v\u1eabn c\xf3 ",(0,r.jsx)(e.code,{children:"token-2"})," v\xe0 t\u1ea1i th\u1eddi \u0111i\u1ec3m n\xe0y, b\u1ea1n \u0111\xe3 ho\xe0n th\xe0nh!"]}),(0,r.jsx)(e.hr,{}),(0,r.jsx)(e.h2,{id:"t\u1ed5ng-k\u1ebft",children:"T\u1ed5ng k\u1ebft"}),(0,r.jsxs)(e.p,{children:["Trong b\xe0i h\u01b0\u1edbng d\u1eabn n\xe0y, b\u1ea1n \u0111\xe3 h\u1ecdc c\xe1ch l\xe0m th\u1ebf n\xe0o \u0111\u1ec3 m\u1edf r\u1ed9ng m\u1ed9t NFT contract th\xf4ng qua mint function v\xe0 b\u1ea1n \u0111\xe3 bi\u1ebft th\xeam c\xe1ch \u0111\u1ec3 ng\u01b0\u1eddi d\xf9ng transfer c\xe1c NFT. B\u1ea1n \u0111\xe3 ",(0,r.jsx)(e.a,{href:"#introduction",children:"chia nh\u1ecf"})," v\u1ea5n \u0111\u1ec1 th\xe0nh c\xe1c v\u1ea5n \u0111\u1ec1 b\xe9 h\u01a1n, nhi\u1ec1u subtask d\u1ec5 x\u1eed l\xfd h\u01a1n v\xe0 l\u1ea5y th\xf4ng tin \u0111\xf3 \u0111\u1ec3 tri\u1ec3n khai c\u1ea3 hai function l\xe0 ",(0,r.jsx)(e.a,{href:"#transfer-function",children:"NFT transfer"})," v\xe0 ",(0,r.jsx)(e.a,{href:"#transfer-call-function",children:"NFT transfer call"}),". Ngo\xe0i ra, b\u1ea1n \u0111\xe3 deploy ",(0,r.jsx)(e.a,{href:"#redeploying-contract",children:"b\u1ea3n v\xe1 l\u1ed7i"})," kh\xe1c t\u1edbi smart contract c\u1ee7a m\xecnh v\xe0 ",(0,r.jsx)(e.a,{href:"#testing-changes",children:"\u0111\xe3 test"})," ch\u1ee9c n\u0103ng transfer."]}),(0,r.jsxs)(e.p,{children:["In the ",(0,r.jsx)(e.a,{href:"/vi/tutorials/nfts/approvals",children:"next tutorial"}),", you'll learn about the approval management system and how you can approve others to transfer tokens on your behalf."]}),(0,r.jsxs)(e.admonition,{title:"Versioning for this article",type:"note",children:[(0,r.jsx)(e.p,{children:"At the time of this writing, this example works with the following versions:"}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["rustc: ",(0,r.jsx)(e.code,{children:"1.77.1"})]}),"\n",(0,r.jsxs)(e.li,{children:["near-cli-rs: ",(0,r.jsx)(e.code,{children:"0.11.0"})]}),"\n",(0,r.jsxs)(e.li,{children:["cargo-near ",(0,r.jsx)(e.code,{children:"0.6.1"})]}),"\n",(0,r.jsxs)(e.li,{children:["NFT standard: ",(0,r.jsx)(e.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Core",children:"NEP171"}),", version ",(0,r.jsx)(e.code,{children:"1.0.0"})]}),"\n",(0,r.jsxs)(e.li,{children:["Enumeration standard: ",(0,r.jsx)(e.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Enumeration",children:"NEP181"}),", version ",(0,r.jsx)(e.code,{children:"1.0.0"})]}),"\n"]})]})]})]})]})]})]})}function u(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},85162:(n,e,t)=>{t.d(e,{Z:()=>a});t(67294);var r=t(36905);const i={tabItem:"tabItem_Ymn6"};var s=t(85893);function a(n){var e=n.children,t=n.hidden,a=n.className;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.Z)(i.tabItem,a),hidden:t,children:e})}},74866:(n,e,t)=>{t.d(e,{Z:()=>k});var r=t(67294),i=t(36905),s=t(12466),a=t(16550),c=t(20469),o=t(91980),l=t(67392),h=t(50012);function d(n){var e,t;return null!=(e=null==(t=r.Children.toArray(n).filter((function(n){return"\n"!==n})).map((function(n){if(!n||(0,r.isValidElement)(n)&&((e=n.props)&&"object"==typeof e&&"value"in e))return n;var e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof n.type?n.type:n.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?e:[]}function u(n){var e=n.values,t=n.children;return(0,r.useMemo)((function(){var n=null!=e?e:function(n){return d(n).map((function(n){var e=n.props;return{value:e.value,label:e.label,attributes:e.attributes,default:e.default}}))}(t);return function(n){var e=(0,l.l)(n,(function(n,e){return n.value===e.value}));if(e.length>0)throw new Error('Docusaurus error: Duplicate values "'+e.map((function(n){return n.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(n),n}),[e,t])}function f(n){var e=n.value;return n.tabValues.some((function(n){return n.value===e}))}function m(n){var e=n.queryString,t=void 0!==e&&e,i=n.groupId,s=(0,a.k6)(),c=function(n){var e=n.queryString,t=void 0!==e&&e,r=n.groupId;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=r?r:null}({queryString:t,groupId:i});return[(0,o._X)(c),(0,r.useCallback)((function(n){if(c){var e=new URLSearchParams(s.location.search);e.set(c,n),s.replace(Object.assign({},s.location,{search:e.toString()}))}}),[c,s])]}function g(n){var e,t,i,s,a=n.defaultValue,o=n.queryString,l=void 0!==o&&o,d=n.groupId,g=u(n),p=(0,r.useState)((function(){return function(n){var e,t=n.defaultValue,r=n.tabValues;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!f({value:t,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+r.map((function(n){return n.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}var i=null!=(e=r.find((function(n){return n.default})))?e:r[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:a,tabValues:g})})),x=p[0],j=p[1],v=m({queryString:l,groupId:d}),b=v[0],y=v[1],k=(e=function(n){return n?"docusaurus.tab."+n:null}({groupId:d}.groupId),t=(0,h.Nk)(e),i=t[0],s=t[1],[i,(0,r.useCallback)((function(n){e&&s.set(n)}),[e,s])]),_=k[0],T=k[1],w=function(){var n=null!=b?b:_;return f({value:n,tabValues:g})?n:null}();return(0,c.Z)((function(){w&&j(w)}),[w]),{selectedValue:x,selectValue:(0,r.useCallback)((function(n){if(!f({value:n,tabValues:g}))throw new Error("Can't select invalid tab value="+n);j(n),y(n),T(n)}),[y,T,g]),tabValues:g}}var p=t(72389);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=t(85893);function v(n){var e=n.className,t=n.block,r=n.selectedValue,a=n.selectValue,c=n.tabValues,o=[],l=(0,s.o5)().blockElementScrollPositionUntilNextRender,h=function(n){var e=n.currentTarget,t=o.indexOf(e),i=c[t].value;i!==r&&(l(e),a(i))},d=function(n){var e,t=null;switch(n.key){case"Enter":h(n);break;case"ArrowRight":var r,i=o.indexOf(n.currentTarget)+1;t=null!=(r=o[i])?r:o[0];break;case"ArrowLeft":var s,a=o.indexOf(n.currentTarget)-1;t=null!=(s=o[a])?s:o[o.length-1]}null==(e=t)||e.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":t},e),children:c.map((function(n){var e=n.value,t=n.label,s=n.attributes;return(0,j.jsx)("li",Object.assign({role:"tab",tabIndex:r===e?0:-1,"aria-selected":r===e,ref:function(n){return o.push(n)},onKeyDown:d,onClick:h},s,{className:(0,i.Z)("tabs__item",x.tabItem,null==s?void 0:s.className,{"tabs__item--active":r===e}),children:null!=t?t:e}),e)}))})}function b(n){var e=n.lazy,t=n.children,i=n.selectedValue,s=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){var a=s.find((function(n){return n.props.value===i}));return a?(0,r.cloneElement)(a,{className:"margin-top--md"}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:s.map((function(n,e){return(0,r.cloneElement)(n,{key:e,hidden:n.props.value!==i})}))})}function y(n){var e=g(n);return(0,j.jsxs)("div",{className:(0,i.Z)("tabs-container",x.tabList),children:[(0,j.jsx)(v,Object.assign({},e,n)),(0,j.jsx)(b,Object.assign({},e,n))]})}function k(n){var e=(0,p.Z)();return(0,j.jsx)(y,Object.assign({},n,{children:d(n.children)}),String(e))}},71183:(n,e,t)=>{t.d(e,{O2:()=>m,Ey:()=>p,SQ:()=>g});var r=t(67294),i=t(74866),s=t(85162),a=t(74165),c=t(15861),o=t(1841),l=t.n(o),h=t(85893);function d(){return(d=(0,c.Z)((0,a.Z)().mark((function n(e,t,r){var i,s,c,o;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((s=localStorage.getItem(e+"-until"))&&s>Date.now())){n.next=5;break}i=localStorage.getItem(e),n.next=18;break;case 5:return n.prev=5,n.next=8,fetch(e);case 8:return n.next=10,n.sent.text();case 10:i=n.sent,localStorage.setItem(e,i),localStorage.setItem(e+"-until",Date.now()+6e4),n.next=18;break;case 15:return n.prev=15,n.t0=n.catch(5),n.abrupt("return","Error fetching code, please try reloading");case 18:return c=i.split("\n"),t=t?Number(t)-1:0,r=r?Number(r):c.length,c=c.slice(t,r),o=c.reduce((function(n,e){if(0===e.length)return n;var t=e.match(/^\s+/);return t?Math.min(n,t[0].length):0}),1/0),n.abrupt("return",c.map((function(n){return n.slice(o)})).join("\n"));case 24:case"end":return n.stop()}}),n,null,[[5,15]])})))).apply(this,arguments)}const u=function(n){var e=n.url,t=n.start,i=n.end,s=n.language,a=n.fname,c=n.metastring,o=(0,r.useState)("Loading..."),u=o[0],f=o[1];return(0,r.useEffect)((function(){var n=function(n){var e=n.slice(n.indexOf("https")).split("#"),t=e[0],r=(e[1],new URL(t).pathname.split("/").slice(1)),i=r[0],s=r[1];return r[2],"https://raw.githubusercontent.com/"+i+"/"+s+"/"+r[3]+"/"+r.slice(4).join("/")}(e),r=function(n,e,t){return d.apply(this,arguments)}(n,t,i);r.then((function(n){return f(n)}))})),(0,h.jsxs)("div",{fname:a,children:[(0,h.jsx)(l(),{language:s,metastring:c+" showLineNumbers",children:u}),(0,h.jsx)("div",{style:{fontSize:"0.9em",fontWeight:600,color:"rgb(14, 117, 221)",textAlign:"center",paddingBottom:"13px",textDecoration:"underline"},children:(0,h.jsx)("a",{href:e,target:"_blank",rel:"noreferrer noopener",children:"See full example on GitHub"})})]})};var f={rust:"\ud83e\udd80 Rust",js:"\ud83c\udf10 Javascript",ts:"\ud83c\udf10 Typescript"};function m(n){var e=n.children;return Array.isArray(e)||(e=[e]),(0,h.jsx)(i.Z,{className:"language-tabs",groupId:"code-tabs",children:e.map((function(n,e){return(0,h.jsx)(s.Z,{value:n.props.value,label:f[n.props.value],children:n})}))})}function g(n){var e=n.children,t=n.language;return Array.isArray(e)||(e=[e]),e=e.map((function(n){return function(n,e){var t=n.props,r=(t.children,t.url),i=t.start,s=t.end,a=t.fname;if(n.type===p)return p({url:r,start:i,end:s,language:e,fname:a});return n}(n,t)})),1==e.length?(0,h.jsx)(s.Z,{value:0,label:e[0].props.fname,children:e[0]}):(0,h.jsx)(i.Z,{className:"file-tabs",children:e.map((function(n,e){return(0,h.jsx)(s.Z,{value:e,label:n.props.fname,children:n})}))})}function p(n){var e=n.url,t=n.start,r=n.end,i=n.language,s=n.fname,a=n.metastring;return u({url:e,start:t,end:r,language:i,fname:s,metastring:a})}}}]);