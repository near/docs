<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/nfts/approvals" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Approvals | NEAR Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.near.org/zh-CN/img/near_logo.svg"><meta data-rh="true" name="twitter:image" content="https://docs.near.org/zh-CN/img/near_logo.svg"><meta data-rh="true" property="og:url" content="https://docs.near.org/zh-CN/tutorials/nfts/approvals"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="ko"><meta data-rh="true" property="og:locale:alternate" content="vi"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Approvals | NEAR Documentation"><meta data-rh="true" name="description" content="In this tutorial you&#x27;ll learn the basics of an approval management system which will allow you to grant others access to transfer NFTs on your behalf. This is the backbone of all NFT marketplaces and allows for some complex yet beautiful scenarios to happen. If you&#x27;re joining us for the first time, feel free to clone this repository and checkout the 4.core branch to follow along."><meta data-rh="true" property="og:description" content="In this tutorial you&#x27;ll learn the basics of an approval management system which will allow you to grant others access to transfer NFTs on your behalf. This is the backbone of all NFT marketplaces and allows for some complex yet beautiful scenarios to happen. If you&#x27;re joining us for the first time, feel free to clone this repository and checkout the 4.core branch to follow along."><link data-rh="true" rel="icon" href="/zh-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.near.org/zh-CN/tutorials/nfts/approvals"><link data-rh="true" rel="alternate" href="https://docs.near.org/tutorials/nfts/approvals" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.near.org/ko/tutorials/nfts/approvals" hreflang="ko"><link data-rh="true" rel="alternate" href="https://docs.near.org/vi/tutorials/nfts/approvals" hreflang="vi"><link data-rh="true" rel="alternate" href="https://docs.near.org/zh-CN/tutorials/nfts/approvals" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://docs.near.org/tutorials/nfts/approvals" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0LUM67N2P2-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-100373569-7","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="NEAR Documentation" href="/zh-CN/opensearch.xml">






<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&family=Source+Code+Pro:ital,wght@0,400;0,600;1,400;1,600&display=swap">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://use.fontawesome.com/221fd444f5.js"></script><link rel="stylesheet" href="/zh-CN/assets/css/styles.7e942ff1.css">
<script src="/zh-CN/assets/js/runtime~main.06816ca5.js" defer="defer"></script>
<script src="/zh-CN/assets/js/main.42c8cd4f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#333" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">‚õìÔ∏è <a href="/concepts/abstraction/chain-signatures">Chain Signatures</a> ‚õìÔ∏è - Sign and send transactions on Bitcoin, Ethereum, and more! üîë </div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/img/near_logo.svg" alt="NEAR Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh-CN/img/near_logo_white.svg" alt="NEAR Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/zh-CN/concepts/welcome">Concepts</a><a class="navbar__item navbar__link" href="/zh-CN/develop/welcome">Build</a><a class="navbar__item navbar__link" href="/zh-CN/tutorials/welcome">Tutorials</a><a class="navbar__item navbar__link" href="/zh-CN/api/rpc/introduction">RPC</a><div class="navbar__item"><span class="separator"></span></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Tools</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/tools/welcome">üß∞ All Tools</a></li><li><hr> <small class="subtitle"> Essentials </small></li><li><a class="dropdown__link" href="/zh-CN/tools/near-api-js/quick-reference">NEAR API</a></li><li><a class="dropdown__link" href="/zh-CN/sdk/welcome">NEAR SDK</a></li><li><a class="dropdown__link" href="/zh-CN/tools/near-cli">NEAR CLI</a></li><li><hr> <small class="subtitle"> Onboarding </small></li><li><a class="dropdown__link" href="/zh-CN/tools/wallet-selector">Wallet Selector</a></li><li><a class="dropdown__link" href="/zh-CN/tools/fastauth-sdk">FastAuth (Email Login)</a></li><li><a class="dropdown__link" href="/zh-CN/develop/relayers/build-relayer">Relayers</a></li><li><hr> <small class="subtitle"> IDEs </small></li><li><a class="dropdown__link" href="/zh-CN/bos/dev/vscode">VSCode Extension </a></li><li><a href="https://jutsu.ai/editor" target="_blank" rel="noopener noreferrer" class="dropdown__link">BOS Web IDE (Jutsu)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://docs.welldonestudio.io/code/getting-started" target="_blank" rel="noopener noreferrer" class="dropdown__link">Remix IDE Plugin<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/changelog">üéâ Dev Changelog</a></li><li><a href="https://github.com/near" target="_blank" rel="noopener noreferrer" class="dropdown__link header-github-link">Github<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr><div class="subtitle"> Support </div></li><li><a href="https://discord.gg/GZ7735Xjce" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://t.me/neardev" target="_blank" rel="noopener noreferrer" class="dropdown__link">Telegram<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr><div class="subtitle"> Other Docs </div></li><li><a href="https://nomicon.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">Protocol Docs<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://near-nodes.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">Validator Docs<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://aurora.dev" target="_blank" rel="noopener noreferrer" class="dropdown__link">Aurora (EVM)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>ÁÆÄ‰Ωì‰∏≠Êñá</a><ul class="dropdown__menu"><li><a href="/tutorials/nfts/approvals" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/ko/tutorials/nfts/approvals" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">ÌïúÍµ≠Ïñ¥</a></li><li><a href="/vi/tutorials/nfts/approvals" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="vi">Ti·∫øng Vi·ªát</a></li><li><a href="/zh-CN/tutorials/nfts/approvals" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</a></li></ul></div><button class="navbar__item navbar__link btn_jI7_"> <!-- -->Loading...<!-- --> </button><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/img/near_logo.svg" alt="NEAR Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh-CN/img/near_logo_white.svg" alt="NEAR Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="toggle_vylO margin-right--md"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><button type="button" aria-label="Close navigation bar" class="clean-btn navbar-sidebar__close"><svg viewBox="0 0 15 15" width="21" height="21"><g stroke="var(--ifm-color-emphasis-600)" stroke-width="1.2"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><div class="navbar-sidebar__items"><div class="navbar-sidebar__item menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/zh-CN/concepts/welcome">Concepts</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/develop/welcome">Build</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/tutorials/welcome">Tutorials</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/api/rpc/introduction">RPC</a></li><div class="menu__list-item"><span class="separator"></span></div><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_S0Fm menu__link menu__link--sublist menu__link--sublist-caret">Tools</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_S0Fm menu__link menu__link--sublist menu__link--sublist-caret">Resources</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="dropdownNavbarItemMobile_S0Fm menu__link menu__link--sublist menu__link--sublist-caret"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Languages</a></li><li class="menu__list-item"><button class="menu__link btn_jI7_"> <!-- -->Loading...<!-- --> </button></li></ul></div><div class="navbar-sidebar__item menu"><button type="button" class="clean-btn navbar-sidebar__back">‚Üê Back to main menu</button></div></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/tutorials/welcome">Home</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><hr></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><span class="menu__link"><b><small> Examples </small></b></span></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/tutorials/examples/count-near">Frontend &amp; Smart Contract</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/tutorials/examples/factory">Advanced Contracts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/tutorials/examples/frontend-multiple-contracts">Frontend &amp; Multiple Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><hr></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><span class="menu__link"><b><small> Tutorials </small></b></span></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/bos/dev/bos-loader">Components</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/tutorials/fts/introduction">Fungible Tokens 101 (FT)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-CN/tutorials/nfts/minting-nfts">Non-Fungible Tokens (NFT)</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/minting-nfts">Minting NFTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/minting-nft-frontend">Minting Front-end</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/minecraft-nfts">Minecraft NFTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://github.com/near-examples/nft-tutorial-frontend" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Building a Frontend<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2"><hr></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/zh-CN/tutorials/nfts/js/introduction">üåê Contract: Zero to Hero </a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/zh-CN/tutorials/nfts/introduction">ü¶Ä Contract: Zero to Hero</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/predeployed-contract">Pre-deployed Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/skeleton">Contract Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/minting">Minting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/upgrade-contract">Upgrade a Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/enumeration">Enumeration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/core">Core</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-CN/tutorials/nfts/approvals">Approvals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/royalty">Royalty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/events">Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/marketplace">Marketplace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/tutorials/nfts/series">Lazy Minting, Collections, and More!</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/tutorials/crosswords/basics/overview">Build a Crossword Game</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/bos/tutorial/indexer-tutorials/posts-indexer">Data Infrastructure</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/zh-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Non-Fungible Tokens (NFT)</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ü¶Ä Contract: Zero to Hero</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Approvals</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Approvals</h1></header><p>In this tutorial you&#x27;ll learn the basics of an approval management system which will allow you to grant others access to transfer NFTs on your behalf. This is the backbone of all NFT marketplaces and allows for some complex yet beautiful scenarios to happen. If you&#x27;re joining us for the first time, feel free to clone <a href="https://github.com/near-examples/nft-tutorial" target="_blank" rel="noopener noreferrer">this repository</a> and checkout the <code>4.core</code> branch to follow along.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">git checkout 4.core</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>If you wish to see the finished code for this <em>Approval</em> tutorial, you can find it on the <code>5.approval</code> branch. :::</div><div class="admonitionContent_BuS1"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">‚Äã</a></h2><p>Up until this point you&#x27;ve created a smart contract that allows users to mint and transfer NFTs as well as query for information using the <a href="https://nomicon.io/Standards/Tokens/NonFungibleToken/Enumeration" target="_blank" rel="noopener noreferrer">enumeration standard</a>. As we&#x27;ve been doing in the previous tutorials, let&#x27;s break down the problem into smaller, more digestible, tasks. Let&#x27;s first define some of the end goals that we want to accomplish as per the <a href="https://nomicon.io/Standards/Tokens/NonFungibleToken/ApprovalManagement" target="_blank" rel="noopener noreferrer">approval management</a> extension of the standard. We want a user to have the ability to:</p><ul>
<li>Grant other accounts access to transfer their NFTs on a per token basis.</li>
<li>Check if an account has access to a specific token.</li>
<li>Revoke a specific account the ability to transfer an NFT.</li>
<li>Revoke <strong>all</strong> other accounts the ability to transfer an NFT.</li>
</ul><p>If you look at all these goals, they are all on a per token basis. This is a strong indication that you should change the <code>Token</code> struct which keeps track of information for each token.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="allow-an-account-to-transfer-your-nft">Allow an account to transfer your NFT<a href="#allow-an-account-to-transfer-your-nft" class="hash-link" aria-label="Direct link to Allow an account to transfer your NFT" title="Direct link to Allow an account to transfer your NFT">‚Äã</a></h2><p>Let&#x27;s start by trying to accomplish the first goal. How can you grant another account access to transfer an NFT on your behalf?</p><p>The simplest way that you can achieve this is to add a list of approved accounts to the <code>Token</code> struct. When transferring the NFT, if the caller is not the owner, you could check if they&#x27;re in the list.</p><p>Before transferring, you would need to clear the list of approved accounts since the new owner wouldn&#x27;t expect the accounts approved by the original owner to still have access to transfer their new NFT.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-problem">The problem<a href="#the-problem" class="hash-link" aria-label="Direct link to The problem" title="Direct link to The problem">‚Äã</a></h3><p>On the surface, this would work, but if you start thinking about the edge cases, some problems arise. Often times when doing development, a common approach is to think about the easiest and most straightforward solution. Once you&#x27;ve figured it out, you can start to branch off and think about optimizations and edge cases.</p><p>Let&#x27;s consider the following scenario. Benji has an NFT and gives two separate marketplaces access to transfer his token. By doing so, he&#x27;s putting the NFT for sale (more about that in the <a href="#marketplace-integrations">marketplace integrations</a> section). Let&#x27;s say he put the NFT for sale for 1 NEAR on both markets. The tokens list of approved account IDs would look like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Token: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    owner_id: Benji</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    approved_accounts_ids: [marketplace A, marketplace B]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Josh then comes along and purchases the NFT on marketplace A for 1 NEAR. This would take the sale down from the marketplace A and clear the list of approved accounts. Marketplace B, however, still has the token listed for sale for 1 NEAR and has no way of knowing that the token was purchased on marketplace A by Josh. The new token struct would look as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Token: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    owner_id: Josh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    approved_accounts_ids: []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s say Josh is low on cash and wants to flip this NFT and put it for sale for 10 times the price on marketplace B. He goes to put it for sale and for whatever reason, the marketplace is built in a way that if you try to put a token up for sale twice, it keeps the old sale data. This would mean that from marketplace B&#x27;s perspective, the token is still for sale for 1 NEAR (which was the price that Benji had originally listed it for).</p><p>Since Josh approved the marketplace to try and put it for sale, the token struct would look as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Token: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    owner_id: Josh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    approved_accounts_ids: [marketplace A, marketplace B]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If Mike then comes along and purchases the NFT for only 1 NEAR on marketplace B, the marketplace would go to try and transfer the NFT and since technically, Josh approved the marketplace and it&#x27;s in the list of approved accounts, the transaction would go through properly.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-solution">The solution<a href="#the-solution" class="hash-link" aria-label="Direct link to The solution" title="Direct link to The solution">‚Äã</a></h3><p>Now that we&#x27;ve identified a problem with the original solution, let&#x27;s think about ways that we can fix it. What would happen now if, instead of just keeping track of a list of approved accounts, you introduced a specific ID that went along with each approved account. The new approved accounts would now be a map instead of a list. It would map an account to it&#x27;s <code>approval id</code>.</p><p>For this to work, you need to make sure that the approval ID is <strong>always</strong> a unique, new ID. If you set it as an integer that always increases by 1 whenever u approve an account, this should work. Let&#x27;s consider the same scenario with the new solution.</p><p>Benji puts his NFT for sale for 1 NEAR on marketplace A and marketplace B by approving both marketplaces. The &quot;next approval ID&quot; would start off at 0 when the NFT was first minted and will increase from there. This would result in the following token struct:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Token: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    owner_id: Benji</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    approved_accounts_ids: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        marketplace A: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        marketplace B: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    next_approval_id: 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When Benji approved marketplace A, it took the original value of <code>next_approval_id</code> which started off at 0. The marketplace was then inserted into the map and the next approval ID was incremented. This process happened again for marketplace B and the next approval ID was again incremented where it&#x27;s now 2.</p><p>Josh comes along and purchases the NFT on marketplace A for 1 NEAR. Notice how the next approval ID stayed at 2:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Token: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    owner_id: Josh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    approved_accounts_ids: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    next_approval_id: 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Josh then flips the NFT because he&#x27;s once again low on cash and approves marketplace B:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Token: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    owner_id: Josh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    approved_accounts_ids: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        marketplace B: 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    next_approval_id: 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The marketplace is inserted into the map and the next approval ID is incremented. From marketplace B&#x27;s perspective it stores it&#x27;s original approval ID from when Benji put the NFT up for sale which has a value of 1. If Mike were to go and purchase the NFT on marketplace B for the original 1 NEAR sale price, the NFT contract should panic. This is because the marketplace is trying to transfer the NFT with an approval ID 1 but the token struct shows that it <strong>should</strong> have an approval ID of 2.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="expanding-the-token-and-jsontoken-structs">Expanding the <code>Token</code> and <code>JsonToken</code> structs<a href="#expanding-the-token-and-jsontoken-structs" class="hash-link" aria-label="Direct link to expanding-the-token-and-jsontoken-structs" title="Direct link to expanding-the-token-and-jsontoken-structs">‚Äã</a></h3><p>Now that you understand the proposed solution to the original problem of allowing an account to transfer your NFT, it&#x27;s time to implement some of the logic. The first thing you should do is modify the <code>Token</code> and <code>JsonToken</code> structs to reflect the new changes. Let&#x27;s switch over to the <code>nft-contract/src/metadata.rs</code> file:</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/metadata.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/metadata.rs#L39-L61#" target="_blank">See full example on GitHub</a></div></div><p>You&#x27;ll then need to initialize both the <code>approved_account_ids</code> and <code>next_approval_id</code> to their default values when a token is minted. Switch to the <code>nft-contract/src/mint.rs</code> file and when creating the <code>Token</code> struct to store in the contract, let&#x27;s set the next approval ID to be 0 and the approved account IDs to be an empty map:</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/mint.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/mint.rs#L15-L22#" target="_blank">See full example on GitHub</a></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="approving-accounts">Approving accounts<a href="#approving-accounts" class="hash-link" aria-label="Direct link to Approving accounts" title="Direct link to Approving accounts">‚Äã</a></h3><p>Now that you&#x27;ve added the support for approved account IDs and the next approval ID on the token level, it&#x27;s time to add the logic for populating and changing those fields through a function called <code>nft_approve</code>. This function should approve an account to have access to a specific token ID. Let&#x27;s move to the <code>nft-contract/src/approval.rs</code> file and edit the <code>nft_approve</code> function:</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/approval.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/approval.rs#L38-L96#" target="_blank">See full example on GitHub</a></div></div><p>The function will first assert that the user has attached <strong>at least</strong> one yoctoNEAR (which we&#x27;ll implement soon). This is both for security and to cover storage. When someone approves an account ID, they&#x27;re storing that information on the contract. As you saw in the <a href="/zh-CN/tutorials/nfts/minting">minting tutorial</a>, you can either have the smart contract account cover the storage, or you can have the users cover that cost. The latter is more scalable and it&#x27;s the approach you&#x27;ll be working with throughout this tutorial.</p><p>After the assertion comes back with no problems, you get the token object and make sure that only the owner is calling this method. Only the owner should be able to allow other accounts to transfer their NFTs. You then get the next approval ID and insert the passed in account into the map with the next approval ID. If it&#x27;s a new approval ID, storage must be paid. If it&#x27;s not a new approval ID, no storage needs to be paid and only attaching 1 yoctoNEAR would be enough.</p><p>You then calculate how much storage is being used by adding that new account to the map and increment the tokens <code>next_approval_id</code> by 1. After inserting the token object back into the <code>tokens_by_id</code> map, you refund any excess storage.</p><p>You&#x27;ll notice that the function contains an optional <code>msg</code> parameter. This message is actually the foundation of all NFT marketplaces on NEAR.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="marketplace-integrations">Marketplace Integrations<a href="#marketplace-integrations" class="hash-link" aria-label="Direct link to Marketplace Integrations" title="Direct link to Marketplace Integrations">‚Äã</a></h4><p>If a message was provided into the function, you&#x27;re going to perform a cross contract call to the account being given access. This cross contract call will invoke the <code>nft_on_approve</code> function which will parse the message and act accordingly. Let&#x27;s consider a general use case.</p><p>We have a marketplace that expects it&#x27;s sale conditions to be passed in through the message field. Benji approves the marketplace with the <code>nft_approve</code> function and passes in a stringified JSON to the message which will outline sale conditions. These sale conditions could look something like the following:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sale_conditions: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    price: 5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By leaving the message field type as just a string, this generalizes the process and allows users to input sale conditions for many different marketplaces. It is up to the person approving to pass in an appropriate message that the marketplace can properly decode and use. This is usually done through the marketplace&#x27;s frontend app which would know how to construct the <code>msg</code> in a useful way.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="internal-functions">Internal functions<a href="#internal-functions" class="hash-link" aria-label="Direct link to Internal functions" title="Direct link to Internal functions">‚Äã</a></h4><p>Now that the core logic for approving an account is finished, you need to implement the <code>assert_at_least_one_yocto</code> and <code>bytes_for_approved_account</code> functions. Move to the <code>nft-contract/src/internal.rs</code> file and copy the following function right below the <code>assert_one_yocto</code> function.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/internal.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/internal.rs#L52-L58#" target="_blank">See full example on GitHub</a></div></div><p>Next, you&#x27;ll need to copy the logic for calculating how many bytes it costs to store an account ID. Place this function at the very top of the page:</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/internal.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/internal.rs#L1-L9#" target="_blank">See full example on GitHub</a></div></div><p>Now that the logic for approving accounts is finished, you need to change the restrictions for transferring.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="changing-the-restrictions-for-transferring-nfts">Changing the restrictions for transferring NFTs<a href="#changing-the-restrictions-for-transferring-nfts" class="hash-link" aria-label="Direct link to Changing the restrictions for transferring NFTs" title="Direct link to Changing the restrictions for transferring NFTs">‚Äã</a></h3><p>Currently, an NFT can <strong>only</strong> be transferred by its owner. You need to change that restriction so that people that have been approved can also transfer NFTs. In addition, you&#x27;ll make it so that if an approval ID is passed, you can increase the security and check if both the account trying to transfer is in the approved list <strong>and</strong> they correspond to the correct approval ID. This is to address the problem we ran into earlier.</p><p>In the <code>internal.rs</code> file, you need to change the logic of the <code>internal_transfer</code> method as that&#x27;s where the restrictions are being made. Change the internal transfer function to be the following:</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/internal.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/internal.rs#L135-L201#" target="_blank">See full example on GitHub</a></div></div><p>This will check if the sender isn&#x27;t the owner and then if they&#x27;re not, it will check if the sender is in the approval list. If an approval ID was passed into the function, it will check if the sender&#x27;s actual approval ID stored on the contract matches the one passed in.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="refunding-storage-on-transfer">Refunding storage on transfer<a href="#refunding-storage-on-transfer" class="hash-link" aria-label="Direct link to Refunding storage on transfer" title="Direct link to Refunding storage on transfer">‚Äã</a></h4><p>While you&#x27;re in the internal file, you&#x27;re going to need to add methods for refunding users who have paid for storing approved accounts on the contract when an NFT is transferred. This is because you&#x27;ll be clearing the <code>approved_account_ids</code> map whenever NFTs are transferred and so the storage is no longer being used.</p><p>Right below the <code>bytes_for_approved_account_id</code> function, copy the following two functions:</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/internal.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/internal.rs#L11-L32#" target="_blank">See full example on GitHub</a></div></div><p>These will be useful in the next section where you&#x27;ll be changing the <code>nft_core</code> functions to include the new approval logic.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="changes-to-nft_corers">Changes to <code>nft_core.rs</code><a href="#changes-to-nft_corers" class="hash-link" aria-label="Direct link to changes-to-nft_corers" title="Direct link to changes-to-nft_corers">‚Äã</a></h3><p>Head over to the <code>nft-contract/src/nft_core.rs</code> file and the first change that you&#x27;ll want to make is to add an <code>approval_id</code> to both the <code>nft_transfer</code> and <code>nft_transfer_call</code> functions. This is so that anyone trying to transfer the token that isn&#x27;t the owner must pass in an approval ID to address the problem seen earlier. If they are the owner, the approval ID won&#x27;t be used as we saw in the <code>internal_transfer</code> function.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/nft_core.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/nft_core.rs#L8-L29#" target="_blank">See full example on GitHub</a></div></div><p>You&#x27;ll then need to add an <code>approved_account_ids</code> map to the parameters of <code>nft_resolve_transfer</code>. This is so that you can refund the list if the transfer went through properly.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/nft_core.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/nft_core.rs#L47-L62#" target="_blank">See full example on GitHub</a></div></div><p>Moving over to <code>nft_transfer</code>, the only change that you&#x27;ll need to make is to pass in the approval ID into the <code>internal_transfer</code> function and then refund the previous tokens approved account IDs after the transfer is finished</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/nft_core.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/nft_core.rs#L67-L96#" target="_blank">See full example on GitHub</a></div></div><p>Next, you need to do the same to <code>nft_transfer_call</code> but instead of refunding immediately, you need to attach the previous token&#x27;s approved account IDs to <code>nft_resolve_transfer</code> instead as there&#x27;s still the possibility that the transfer gets reverted.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/nft_core.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/nft_core.rs#L98-L145#" target="_blank">See full example on GitHub</a></div></div><p>You&#x27;ll also need to add the tokens approved account IDs to the <code>JsonToken</code> being returned by <code>nft_token</code>.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/nft_core.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/nft_core.rs#L147-L163#" target="_blank">See full example on GitHub</a></div></div><p>Finally, you need to add the logic for refunding the approved account IDs in <code>nft_resolve_transfer</code>. If the transfer went through, you should refund the owner for the storage being released by resetting the tokens <code>approved_account_ids</code> field. If, however, you should revert the transfer, it wouldn&#x27;t be enough to just not refund anybody. Since the receiver briefly owned the token, they could have added their own approved account IDs and so you should refund them if they did so.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/nft_core.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/nft_core.rs#L168-L234#" target="_blank">See full example on GitHub</a></div></div><p>With that finished, it&#x27;s time to move on and complete the next task.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="check-if-an-account-is-approved">Check if an account is approved<a href="#check-if-an-account-is-approved" class="hash-link" aria-label="Direct link to Check if an account is approved" title="Direct link to Check if an account is approved">‚Äã</a></h2><p>Now that the core logic is in place for approving and refunding accounts, it should be smooth sailing from this point on. You now need to implement the logic for checking if an account has been approved. This should take an account and token ID as well as an optional approval ID. If no approval ID was provided, it should simply return whether or not the account is approved.</p><p>If an approval ID was provided, it should return whether or not the account is approved and has the same approval ID as the one provided. Let&#x27;s move to the <code>nft-contract/src/approval.rs</code> file and add the necessary logic to the <code>nft_is_approved</code> function.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/approval.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/approval.rs#L98-L125#" target="_blank">See full example on GitHub</a></div></div><p>Let&#x27;s now move on and add the logic for revoking an account</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="revoke-an-account">Revoke an account<a href="#revoke-an-account" class="hash-link" aria-label="Direct link to Revoke an account" title="Direct link to Revoke an account">‚Äã</a></h2><p>The next step in the tutorial is to allow a user to revoke a specific account from having access to their NFT. The first thing you&#x27;ll want to do is assert one yocto for security purposes. You&#x27;ll then need to make sure that the caller is the owner of the token. If those checks pass, you&#x27;ll need to remove the passed in account from the tokens approved account IDs and refund the owner for the storage being released.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/approval.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/approval.rs#L127-L151#" target="_blank">See full example on GitHub</a></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="revoke-all-accounts">Revoke all accounts<a href="#revoke-all-accounts" class="hash-link" aria-label="Direct link to Revoke all accounts" title="Direct link to Revoke all accounts">‚Äã</a></h2><p>The final step in the tutorial is to allow a user to revoke all accounts from having access to their NFT. This should also assert one yocto for security purposes and make sure that the caller is the owner of the token. You then refund the owner for releasing all the accounts in the map and then clear the <code>approved_account_ids</code>.</p><div><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">nft-contract/src/approval.rs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="font-size:.9em;font-weight:600;color:#0E75DD;text-align:center;padding-bottom:13px;text-decoration:underline"><a href="https://github.com/near-examples/nft-tutorial/blob/5.approval/nft-contract/src/approval.rs#L153-L174#" target="_blank">See full example on GitHub</a></div></div><p>With that finished, it&#x27;s time to deploy and start testing the contract.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing-changes">Testing the new changes<a href="#testing-changes" class="hash-link" aria-label="Direct link to Testing the new changes" title="Direct link to Testing the new changes">‚Äã</a></h2><p>Since these changes affect all the other tokens and the state won&#x27;t be able to automatically be inherited by the new code, simply redeploying the contract will lead to errors. For this reason, it&#x27;s best practice to create a new account and deploy the contract there.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deployment">Deployment<a href="#deployment" class="hash-link" aria-label="Direct link to Deployment" title="Direct link to Deployment">‚Äã</a></h3><p>Next, you&#x27;ll deploy this contract to the network.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export APPROVAL_NFT_CONTRACT_ID=&lt;accountId&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">near create-account $APPROVAL_NFT_CONTRACT_ID --useFaucet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using the build script, build the deploy the contract as you did in the previous tutorials:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">yarn build &amp;&amp; near deploy $APPROVAL_NFT_CONTRACT_ID out/main.wasm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="initialization-and-minting">Initialization and minting<a href="#initialization-and-minting" class="hash-link" aria-label="Direct link to Initialization and minting" title="Direct link to Initialization and minting">‚Äã</a></h3><p>Since this is a new contract, you&#x27;ll need to initialize and mint a token. Use the following command to initialize the contract:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near call $APPROVAL_NFT_CONTRACT_ID new_default_meta &#x27;{&quot;owner_id&quot;: &quot;&#x27;$APPROVAL_NFT_CONTRACT_ID&#x27;&quot;}&#x27; --accountId $APPROVAL_NFT_CONTRACT_ID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, you&#x27;ll need to mint a token. By running this command, you&#x27;ll mint a token with a token ID <code>&quot;approval-token&quot;</code> and the receiver will be your new account.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near call $APPROVAL_NFT_CONTRACT_ID nft_mint &#x27;{&quot;token_id&quot;: &quot;approval-token&quot;, &quot;metadata&quot;: {&quot;title&quot;: &quot;Approval Token&quot;, &quot;description&quot;: &quot;testing out the new approval extension of the standard&quot;, &quot;media&quot;: &quot;https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif&quot;}, &quot;receiver_id&quot;: &quot;&#x27;$APPROVAL_NFT_CONTRACT_ID&#x27;&quot;}&#x27; --accountId $APPROVAL_NFT_CONTRACT_ID --amount 0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can check to see if everything went through properly by calling one of the enumeration functions:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near view $APPROVAL_NFT_CONTRACT_ID nft_tokens_for_owner &#x27;{&quot;account_id&quot;: &quot;&#x27;$APPROVAL_NFT_CONTRACT_ID&#x27;&quot;, &quot;limit&quot;: 10}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This should return an output similar to the following:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;token_id&quot;: &quot;approval-token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;owner_id&quot;: &quot;approval.goteam.examples.testnet&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metadata&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;title&quot;: &quot;Approval Token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;description&quot;: &quot;testing out the new approval extension of the standard&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media&quot;: &quot;https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media_hash&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;copies&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;issued_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;expires_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;starts_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;updated_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;extra&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference_hash&quot;: null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;approved_account_ids&quot;: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice how the approved account IDs are now being returned from the function? This is a great sign! You&#x27;re now ready to move on and approve an account to have access to your token.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="approving-an-account">Approving an account<a href="#approving-an-account" class="hash-link" aria-label="Direct link to Approving an account" title="Direct link to Approving an account">‚Äã</a></h3><p>At this point, you should have two accounts. One stored under <code>$NFT_CONTRACT_ID</code> and the other under the <code>$APPROVAL_NFT_CONTRACT_ID</code> environment variable. You can use both of these accounts to test things out. If you approve your old account, it should have the ability to transfer the NFT to itself.</p><p>Execute the following command to approve the account stored under <code>$NFT_CONTRACT_ID</code> to have access to transfer your NFT with an ID <code>&quot;approval-token&quot;</code>. You don&#x27;t need to pass a message since the old account didn&#x27;t implement the <code>nft_on_approve</code> function. In addition, you&#x27;ll need to attach enough NEAR to cover the cost of storing the account on the contract. 0.1 NEAR should be more than enough and you&#x27;ll be refunded any excess that is unused.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near call $APPROVAL_NFT_CONTRACT_ID nft_approve &#x27;{&quot;token_id&quot;: &quot;approval-token&quot;, &quot;account_id&quot;: &quot;&#x27;$NFT_CONTRACT_ID&#x27;&quot;}&#x27; --accountId $APPROVAL_NFT_CONTRACT_ID --deposit 0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you call the same enumeration method as before, you should see the new approved account ID being returned.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near view $APPROVAL_NFT_CONTRACT_ID nft_tokens_for_owner &#x27;{&quot;account_id&quot;: &quot;&#x27;$APPROVAL_NFT_CONTRACT_ID&#x27;&quot;, &quot;limit&quot;: 10}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This should return an output similar to the following:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;token_id&quot;: &quot;approval-token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;owner_id&quot;: &quot;approval.goteam.examples.testnet&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metadata&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;title&quot;: &quot;Approval Token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;description&quot;: &quot;testing out the new approval extension of the standard&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media&quot;: &quot;https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media_hash&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;copies&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;issued_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;expires_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;starts_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;updated_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;extra&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference_hash&quot;: null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;approved_account_ids&quot;: { &quot;goteam.examples.testnet&quot;: 0 }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="transferring-the-nft">Transferring an NFT as an approved account<a href="#transferring-the-nft" class="hash-link" aria-label="Direct link to Transferring an NFT as an approved account" title="Direct link to Transferring an NFT as an approved account">‚Äã</a></h3><p>Now that you&#x27;ve approved another account to transfer the token, you can test that behavior. You should be able to use the other account to transfer the NFT to itself by which the approved account IDs should be reset. Let&#x27;s test transferring the NFT with the wrong approval ID:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near call $APPROVAL_NFT_CONTRACT_ID nft_transfer &#x27;{&quot;receiver_id&quot;: &quot;&#x27;$NFT_CONTRACT_ID&#x27;&quot;, &quot;token_id&quot;: &quot;approval-token&quot;, &quot;approval_id&quot;: 1}&#x27; --accountId $NFT_CONTRACT_ID --depositYocto 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Example response: </summary><div><div class="collapsibleContent_i85q"><p></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kind: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ExecutionError: &quot;Smart contract panicked: panicked at &#x27;assertion failed: `(left == right)`\n&quot; +</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &#x27;  left: `0`,\n&#x27; +</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot; right: `1`: The actual approval_id 0 is different from the given approval_id 1&#x27;, src/internal.rs:165:17&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p></p></div></div></details><p>If you pass the correct approval ID which is <code>0</code>, everything should work fine.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near call $APPROVAL_NFT_CONTRACT_ID nft_transfer &#x27;{&quot;receiver_id&quot;: &quot;&#x27;$NFT_CONTRACT_ID&#x27;&quot;, &quot;token_id&quot;: &quot;approval-token&quot;, &quot;approval_id&quot;: 0}&#x27; --accountId $NFT_CONTRACT_ID --depositYocto 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you again call the enumeration method, you should see the owner updated and the approved account IDs reset.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;token_id&quot;: &quot;approval-token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;owner_id&quot;: &quot;goteam.examples.testnet&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metadata&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;title&quot;: &quot;Approval Token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;description&quot;: &quot;testing out the new approval extension of the standard&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media&quot;: &quot;https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media_hash&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;copies&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;issued_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;expires_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;starts_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;updated_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;extra&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference_hash&quot;: null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;approved_account_ids&quot;: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s now test the approval ID incrementing across different owners. If you approve the account that originally minted the token, the approval ID should be 1 now.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near call $APPROVAL_NFT_CONTRACT_ID nft_approve &#x27;{&quot;token_id&quot;: &quot;approval-token&quot;, &quot;account_id&quot;: &quot;&#x27;$APPROVAL_NFT_CONTRACT_ID&#x27;&quot;}&#x27; --accountId $NFT_CONTRACT_ID --deposit 0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Calling the view function again show now return an approval ID of 1 for the account that was approved.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">near view $APPROVAL_NFT_CONTRACT_ID nft_tokens_for_owner &#x27;{&quot;account_id&quot;: &quot;&#x27;$NFT_CONTRACT_ID&#x27;&quot;, &quot;limit&quot;: 10}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Example response: </summary><div><div class="collapsibleContent_i85q"><p></p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;token_id&quot;: &quot;approval-token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;owner_id&quot;: &quot;goteam.examples.testnet&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metadata&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;title&quot;: &quot;Approval Token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;description&quot;: &quot;testing out the new approval extension of the standard&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media&quot;: &quot;https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;media_hash&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;copies&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;issued_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;expires_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;starts_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;updated_at&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;extra&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference&quot;: null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;reference_hash&quot;: null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;approved_account_ids&quot;: { &quot;approval.goteam.examples.testnet&quot;: 1 }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p></p></div></div></details><p>With the testing finished, you&#x27;ve successfully implemented the approvals extension to the standard!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">‚Äã</a></h2><p>Today you went through a lot of logic to implement the <a href="https://nomicon.io/Standards/Tokens/NonFungibleToken/ApprovalManagement" target="_blank" rel="noopener noreferrer">approvals extension</a> so let&#x27;s break down exactly what you did.</p><p>First, you explored the <a href="#basic-solution">basic approach</a> of how to solve the problem. You then went through and discovered some of the <a href="#the-problem">problems</a> with that solution and learned how to <a href="#the-solution">fix it</a>.</p><p>After understanding what you should do to implement the approvals extension, you started to <a href="#expanding-json-and-token">modify</a> the JsonToken and Token structs in the contract. You then implemented the logic for <a href="#approving-accounts">approving accounts</a> and saw how <a href="#marketplace-integrations">marketplaces</a> are integrated.</p><p>After implementing the logic behind approving accounts, you went and <a href="#changing-restrictions">changed the restrictions</a> needed to transfer NFTs. The last step you did to finalize the approving logic was to go back and edit the <a href="#nft-core-changes">nft_core</a> files to be compatible with the new changes.</p><p>At this point, everything was implemented in order to allow accounts to be approved and you extended the functionality of the <a href="https://nomicon.io/Standards/Tokens/NonFungibleToken/Core" target="_blank" rel="noopener noreferrer">core standard</a> to allow for approved accounts to transfer tokens.</p><p>You implemented a view method to <a href="#check-if-account-approved">check</a> if an account is approved and to finish the coding portion of the tutorial, you implemented the logic necessary to <a href="#revoke-account">revoke an account</a> as well as <a href="#revoke-all-accounts">revoke all accounts</a>.</p><p>After this, the contract code was finished and it was time to move onto testing where you created an <a href="#deployment">account</a> and tested the <a href="#approving-an-account">approving</a> and <a href="#transferring-the-nft">transferring</a> for your NFTs.</p><p>In the next tutorial, you&#x27;ll learn about the royalty standards and how you can interact with NFT marketplaces.</p><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Versioning for this article</div><div class="admonitionContent_BuS1"><p>At the time of this writing, this example works with the following versions:</p><ul>
<li>near-cli: <code>4.0.4</code></li>
<li>NFT standard: <a href="https://nomicon.io/Standards/Tokens/NonFungibleToken/Core" target="_blank" rel="noopener noreferrer">NEP171</a>, version <code>1.1.0</code></li>
<li>Enumeration standard: <a href="https://nomicon.io/Standards/Tokens/NonFungibleToken/Enumeration" target="_blank" rel="noopener noreferrer">NEP181</a>, version <code>1.0.0</code></li>
<li>Approval standard: <a href="https://nomicon.io/Standards/Tokens/NonFungibleToken/ApprovalManagement" target="_blank" rel="noopener noreferrer">NEP178</a>, version <code>1.1.0</code></li>
</ul></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/near/docs/edit/master/website/../docs/3.tutorials/nfts/5-approval.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-02-28T20:37:45.000Z">2024Âπ¥2Êúà28Êó•</time></b> by <b>Github Actions</b></span></div></div></footer><div class="theme-admonition theme-admonition-tip admonition_node_modules-@docusaurus-theme-classic-lib-theme-Admonition-Layout-styles-module alert alert--info"><div class="feelback-container"><div class="feelback-q"><span class="feelback-text">Was this page helpful?</span><div class="feelback-buttons"><button class="feelback-btn"><span class="feelback-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500" fill="currentColor" width="1em" height="1em"><g><path d="M172.7,309.1c0-7.4-3-14.6-8.3-19.9s-12.4-8.3-19.9-8.3H74.4c-10.1,0-19.3,5.4-24.4,14.1c-5.1,8.7-5,19.5,0,28.1 s14.3,14.1,24.4,14.1h70.2c7.4,0,14.6-3,19.9-8.3S172.7,316.5,172.7,309.1L172.7,309.1z"></path><path d="M102.5,449.5h70.2c10.1,0,19.3-5.4,24.4-14.1c5-8.6,5-19.5,0-28.1s-14.3-14.1-24.4-14.1h-70.2c-10.1,0-19.3,5.4-24.4,14.1 c-5,8.6-5,19.5,0,28.1C83.2,444.1,92.5,449.5,102.5,449.5z"></path><path d="M53.2,224.9h83.3c18.8,0,36.4-9.4,46.8-24.9l95.7-143.6h5c11.6,0,22.5,5.7,29.2,15.1s8.6,21.6,5,32.5l-25.4,76.5 c-1.3,3.7-0.6,7.9,1.8,11.2c2.3,3.2,6.2,5.2,10.1,5.2h65.6c14.7-0.3,28.8,6.3,37.9,17.7c5.3,6.6,8.6,14.3,9.8,22.6 c1.3,8.3,0.3,16.7-2.7,24.5l-47.6,118.7c-1.5,3.9-4.3,7.2-7.6,9.5c-3.5,2.3-7.5,3.6-11.6,3.6h-61.8l0,0c-7.1-0.3-14.2,2.2-19.7,7 c-5.4,4.6-8.9,11.2-9.9,18.4c-0.8,7.9,1.9,15.8,7.1,21.7c5.4,5.9,12.9,9.2,20.9,9.2h63.3c15.5,0,30.5-4.6,43.2-13.3 c12.8-8.6,22.7-20.9,28.5-35.2l47.6-118.8c12.8-32.1,8.8-68.5-11-97c-19.7-28.5-52.1-45.3-86.8-44.6h-4.6l5.7-17 c5.2-14.8,6.7-30.6,4.3-46.2c-3.6-21.6-14.8-41.3-31.5-55.5s-37.9-22.1-60-22h-20c-9.4,0-18.2,4.6-23.3,12.5l-104,156H54.5 c-7.1-0.1-14.1,2.3-19.6,7c-5.5,4.7-8.9,11.2-9.8,18.3c-0.8,7.9,1.9,15.8,7.1,21.7C37.8,221.4,45.2,224.9,53.2,224.9L53.2,224.9z"></path></g></svg></span><span class="label">Yes</span></button><button class="feelback-btn"><span class="feelback-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500" fill="currentColor" width="1em" height="1em"><g><path d="M327.3,190.8c0,7.3,2.9,14.6,8.3,19.8c5.3,5.3,12.4,8.3,19.8,8.3h70.2c10.1,0,19.4-5.4,24.4-14c5-8.6,5-19.5,0-28.1 c-5-8.6-14.3-14-24.4-14h-70.2c-7.3,0-14.6,2.9-19.8,8.3C330.3,176.3,327.3,183.4,327.3,190.8L327.3,190.8z"></path><path d="M397.5,50.4h-70.2c-10.1,0-19.4,5.4-24.4,14c-5,8.6-5,19.5,0,28.1c5,8.6,14.3,14,24.4,14h70.2c10.1,0,19.4-5.4,24.4-14 s5-19.5,0-28.1S407.6,50.4,397.5,50.4z"></path><path d="M446.8,275.1h-83.3c-18.8,0-36.3,9.5-46.8,25l-95.7,143.6h-5c-11.6,0-22.5-5.7-29.3-15.1c-6.8-9.4-8.6-21.6-5-32.5 l25.4-76.5c1.3-3.8,0.6-7.9-1.8-11.2c-2.3-3.2-6.2-5.1-10.1-5.1h-65.5c-14.7,0.3-28.7-6.3-38.1-17.7c-5.3-6.6-8.6-14.3-9.8-22.6 c-1.3-8.3-0.3-16.6,2.7-24.5l47.6-118.8c1.6-3.9,4.2-7.2,7.6-9.5c3.5-2.3,7.5-3.6,11.6-3.6h61.8l0,0c7.1,0.3,14.2-2.3,19.7-7 c5.4-4.7,8.9-11.3,9.9-18.4c0.7-7.9-1.9-15.8-7.1-21.7c-5.4-6-12.9-9.2-20.9-9.2h-63.3c-15.5,0-30.5,4.7-43.2,13.3 C95.7,72.4,85.8,84.7,80,99L32.4,217.8c-12.8,32.1-8.8,68.5,10.9,97.1c19.7,28.6,52.1,45.2,86.8,44.7h4.7l-5.7,17.1 c-5.1,14.9-6.7,30.6-4.2,46.2c3.6,21.6,14.9,41.3,31.5,55.4s37.9,21.8,59.8,21.7h20c9.5,0,18.2-4.7,23.3-12.5l104.1-156h82.1 c7.1,0.1,14-2.3,19.6-7c5.5-4.7,8.9-11.2,9.8-18.4c0.7-7.9-1.9-15.8-7.1-21.7C462.4,278.5,454.8,275.1,446.8,275.1L446.8,275.1z"></path></g></svg></span><span class="label">No</span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-CN/tutorials/nfts/core"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Core</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-CN/tutorials/nfts/royalty"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Royalty</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#allow-an-account-to-transfer-your-nft" class="table-of-contents__link toc-highlight">Allow an account to transfer your NFT</a><ul><li><a href="#the-problem" class="table-of-contents__link toc-highlight">The problem</a></li><li><a href="#the-solution" class="table-of-contents__link toc-highlight">The solution</a></li><li><a href="#expanding-the-token-and-jsontoken-structs" class="table-of-contents__link toc-highlight">Expanding the <code>Token</code> and <code>JsonToken</code> structs</a></li><li><a href="#approving-accounts" class="table-of-contents__link toc-highlight">Approving accounts</a></li><li><a href="#changing-the-restrictions-for-transferring-nfts" class="table-of-contents__link toc-highlight">Changing the restrictions for transferring NFTs</a></li><li><a href="#changes-to-nft_corers" class="table-of-contents__link toc-highlight">Changes to <code>nft_core.rs</code></a></li></ul></li><li><a href="#check-if-an-account-is-approved" class="table-of-contents__link toc-highlight">Check if an account is approved</a></li><li><a href="#revoke-an-account" class="table-of-contents__link toc-highlight">Revoke an account</a></li><li><a href="#revoke-all-accounts" class="table-of-contents__link toc-highlight">Revoke all accounts</a></li><li><a href="#testing-changes" class="table-of-contents__link toc-highlight">Testing the new changes</a><ul><li><a href="#deployment" class="table-of-contents__link toc-highlight">Deployment</a></li><li><a href="#initialization-and-minting" class="table-of-contents__link toc-highlight">Initialization and minting</a></li><li><a href="#approving-an-account" class="table-of-contents__link toc-highlight">Approving an account</a></li><li><a href="#transferring-the-nft" class="table-of-contents__link toc-highlight">Transferring an NFT as an approved account</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div><div class="container relative text-white pb-40 md:pb-100 pt-100"><div class="row"><div class="col md:w-1/4"><ul class="list-reset text-24 font-black text-yellow mt-50"><li><a href="https://mynearwallet.com/" class="hover:text-white">Wallet</a></li><li><a href="https://nearblocks.io/" class="hover:text-white">Explorer</a></li><li><a href="https://github.com/near-examples/" class="hover:text-white">Examples</a></li><li><a href="https://wiki.near.org/" class="hover:text-white">Wiki</a></li></ul></div><div class="col md:w-3/4 mt-50 md:mt-0" style="z-index:1"><ul class="list-reset flex flex-wrap -mx-20"><li class="mx-20"><a href="https://gov.near.org" class="block hover:text-discourse" target="_blank" id="discourse-1"><span class="icon icon-36"><svg enable-background="new 0 0 34 35" viewBox="0 0 34 35" xmlns="http://www.w3.org/2000/svg"><path d="m0 25.1c0-2.6 0-5.2 0-7.8 0-4.7 1.8-8.8 5.2-12.1 2.6-2.5 5.8-4 9.4-4.5 6.9-1.1 13.7 2.3 17.2 8.4 1.6 3 2.4 6.2 2.2 9.5-.4 4.6-2.3 8.5-5.7 11.6-2.5 2.2-5.4 3.6-8.6 4.1-.6.1-1.3.2-2 .2-5.7 0-11.4 0-17.1 0-.4 0-.5-.1-.5-.5-.1-3-.1-6-.1-8.9zm16.9-17.3c-.6 0-1.2.1-1.8.2-6.2 1.3-9.6 8.1-6.7 13.7.1.3.1.5.1.7-.5 1.6-1 3.2-1.4 4.7-.1.1-.1.3-.1.4.1.1.3 0 .4-.1 1.7-.4 3.4-.9 5.1-1.3.3-.1.6-.1.9.1 1.6.7 3.4.9 5.1.6 5.2-.8 8.9-5.7 8.1-11-.8-4.5-4.8-8-9.7-8z"></path></svg></span><span class="screen-reader-text">Forum</span></a></li><li class="mx-20"><a href="https://twitter.com/nearprotocol" class="block hover:text-twitter" target="_blank"><span class="icon icon-36"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></span><span class="screen-reader-text">Twitter</span></a></li><li class="mx-20"><a href="https://github.com/near" class="block hover:text-github" target="_blank"><span class="icon icon-36"><svg height="36" viewBox="0 0 36 36" width="36" xmlns="http://www.w3.org/2000/svg"><path d="m17.9991429 0c-9.93942861 0-17.9991429 8.058-17.9991429 18.0008571 0 7.9517143 5.15742857 14.6982858 12.3102857 17.0794286.9.1645714 1.2291429-.3908571 1.2291429-.8682857 0-.4268571-.0162857-1.5591429-.0248572-3.0608571-5.0065714 1.0868571-6.06342854-2.4137143-6.06342854-2.4137143-.81857143-2.0785715-1.99885715-2.6322857-1.99885715-2.6322857-1.63371428-1.1177143.12428572-1.0937143.12428572-1.0937143 1.806.1268571 2.75742857 1.8548571 2.75742857 1.8548571 1.60542857 2.7505714 4.2128571 1.956 5.238 1.4948572.1628571-1.1631429.6282857-1.956 1.1425714-2.406-3.9968571-.4542858-8.1985714-1.9988572-8.1985714-8.8962858 0-1.9654285.70114286-3.5717142 1.85228571-4.83-.18514285-.456-.80314285-2.28514281.17657143-4.76399996 0 0 1.51114286-.48342857 4.94999996 1.84542857 1.4357143-.39942857 2.9751429-.59914285 4.506-.606 1.5282858.00685715 3.0685715.20657143 4.5068572.606 3.4362857-2.32885714 4.944-1.84542857 4.944-1.84542857.9831428 2.47885715.3651428 4.30799996.1791428 4.76399996 1.1545715 1.2582858 1.8505715 2.8645715 1.8505715 4.83 0 6.9154286-4.2085715 8.436-8.2182857 8.8825715.6462857.5554285 1.2214285 1.6534285 1.2214285 3.3325714 0 2.4068571-.0214285 4.3482857-.0214285 4.938 0 .4817143.324 1.0414286 1.2377142.8657143 7.146-2.3845714 12.2991429-9.1277143 12.2991429-17.0768572 0-9.9428571-8.0597143-18.0008571-18.0008571-18.0008571"></path></svg></span><span class="screen-reader-text">GitHub</span></a></li><li class="mx-20"><a href="http://near.chat" class="block hover:text-discord" target="_blank"><span class="icon icon-36"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M297.216 243.2c0 15.616-11.52 28.416-26.112 28.416-14.336 0-26.112-12.8-26.112-28.416s11.52-28.416 26.112-28.416c14.592 0 26.112 12.8 26.112 28.416zm-119.552-28.416c-14.592 0-26.112 12.8-26.112 28.416s11.776 28.416 26.112 28.416c14.592 0 26.112-12.8 26.112-28.416.256-15.616-11.52-28.416-26.112-28.416zM448 52.736V512c-64.494-56.994-43.868-38.128-118.784-107.776l13.568 47.36H52.48C23.552 451.584 0 428.032 0 398.848V52.736C0 23.552 23.552 0 52.48 0h343.04C424.448 0 448 23.552 448 52.736zm-72.96 242.688c0-82.432-36.864-149.248-36.864-149.248-36.864-27.648-71.936-26.88-71.936-26.88l-3.584 4.096c43.52 13.312 63.744 32.512 63.744 32.512-60.811-33.329-132.244-33.335-191.232-7.424-9.472 4.352-15.104 7.424-15.104 7.424s21.248-20.224 67.328-33.536l-2.56-3.072s-35.072-.768-71.936 26.88c0 0-36.864 66.816-36.864 149.248 0 0 21.504 37.12 78.08 38.912 0 0 9.472-11.52 17.152-21.248-32.512-9.728-44.8-30.208-44.8-30.208 3.766 2.636 9.976 6.053 10.496 6.4 43.21 24.198 104.588 32.126 159.744 8.96 8.96-3.328 18.944-8.192 29.44-15.104 0 0-12.8 20.992-46.336 30.464 7.68 9.728 16.896 20.736 16.896 20.736 56.576-1.792 78.336-38.912 78.336-38.912z"></path></svg></span><span class="screen-reader-text">Discord</span></a></li><li class="mx-20"><a href="https://t.me/cryptonear" class="block hover:text-telegram" target="_blank"><span class="icon icon-36"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg></span><span class="screen-reader-text">Telegram</span></a></li><li class="mx-20"><a href="https://www.youtube.com/channel/UCuKdIYVN8iE3fv8alyk1aMw" class="block hover:text-youtube" target="_blank"><span class="icon icon-36"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></span><span class="screen-reader-text">YouTube</span></a></li></ul><div class="row"><div class="col sm:w-1/3 mt-50"><h2 class="text-24 font-black text-blue-light">Resources</h2><ul id="menu-developers-1" class="footer-menu list-reset mt-5 text-16 md:text-18"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2045"><a href="https://near.org/devhub.near/widget/app">Contributor Program</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2945"><a target="_blank" rel="noopener noreferrer" href="https://near.org/nearhorizon.near/widget/Index">Startup Accelerator</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6804"><a href="https://gov.near.org/">Forum</a></li></ul></div><div class="col sm:w-1/3 mt-50"><h2 class="text-24 font-black text-blue-light">About</h2><ul id="menu-about-1" class="footer-menu list-reset mt-5 text-16 md:text-18"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-441"><a href="https://near.org/about/">About Us</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-124"><a href="https://careers.near.org/jobs/">Careers</a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3267"><a href="https://near.org/privacy/">Privacy Policy</a></li></ul></div></div></div></div><p class="text-14 mt-50 md:mt-100">Copyright ¬©<!-- -->2024<!-- --> <a href="https://near.org" class="hover:text-yellow">NEAR Protocol</a><span class="mx-10">|</span>All rights reserved<span class="mx-10">|</span><a href="mailto:hello@near.org" class="hover:text-yellow">hello@near.org</a><span class="mx-10">|</span><a href="https://near.org/privacy/" class="hover:text-yellow">Privacy Policy</a><span class="mx-10">|</span>Some icons created by <a href="https://www.flaticon.com/free-icons/coin" title="coin icons">Good Ware, Flaticon, and Freepick</a></p></div></div></footer></div>
</body>
</html>